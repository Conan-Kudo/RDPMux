<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>RDPMux: RDPServerWorker Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RDPMux
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">RDP server multiplexer designed to work with virtual machine framebuffers.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classRDPServerWorker.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classRDPServerWorker-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">RDPServerWorker Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classRDPServerWorker.html" title="The RDPServerWorker class manages the lifetime of the nanomsg socket and the RDP server and connectio...">RDPServerWorker</a> class manages the lifetime of the nanomsg socket and the RDP server and connection associated with the VM.  
 <a href="classRDPServerWorker.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="RDPServerWorker_8h_source.html">RDPServerWorker.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a593ca371fd4c7fd166e7cf43a1a1d664"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a593ca371fd4c7fd166e7cf43a1a1d664">RDPServerWorker</a> (const Glib::ustring &amp;path, int <a class="el" href="classRDPServerWorker.html#a7c48c40c5664ecf56813d064a669a74c">vm_id</a>)</td></tr>
<tr class="memdesc:a593ca371fd4c7fd166e7cf43a1a1d664"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new RDPServerworker object.  <a href="#a593ca371fd4c7fd166e7cf43a1a1d664">More...</a><br /></td></tr>
<tr class="separator:a593ca371fd4c7fd166e7cf43a1a1d664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2881adba1e8c070b58b5b7a2a347b6af"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2881adba1e8c070b58b5b7a2a347b6af"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a2881adba1e8c070b58b5b7a2a347b6af">start</a> ()</td></tr>
<tr class="memdesc:a2881adba1e8c070b58b5b7a2a347b6af"><td class="mdescLeft">&#160;</td><td class="mdescRight">starts the run loop. <br /></td></tr>
<tr class="separator:a2881adba1e8c070b58b5b7a2a347b6af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a33ae474a9bf36d9da56087928abce2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a3a33ae474a9bf36d9da56087928abce2">~RDPServerWorker</a> ()</td></tr>
<tr class="memdesc:a3a33ae474a9bf36d9da56087928abce2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Safely takes down the server worker.  <a href="#a3a33ae474a9bf36d9da56087928abce2">More...</a><br /></td></tr>
<tr class="separator:a3a33ae474a9bf36d9da56087928abce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3deed9d9cfc2362acff5c859b803bf31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a3deed9d9cfc2362acff5c859b803bf31">processIncomingMessage</a> (const <a class="el" href="classQueueItem.html">QueueItem</a> *item)</td></tr>
<tr class="memdesc:a3deed9d9cfc2362acff5c859b803bf31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes incoming messages and dispatches them to the listener appropriately.  <a href="#a3deed9d9cfc2362acff5c859b803bf31">More...</a><br /></td></tr>
<tr class="separator:a3deed9d9cfc2362acff5c859b803bf31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a5c99859ba8b1a0c6261b1532731084b6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5c99859ba8b1a0c6261b1532731084b6"></a>
Glib::Dispatcher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a5c99859ba8b1a0c6261b1532731084b6">socket_creation_done</a></td></tr>
<tr class="memdesc:a5c99859ba8b1a0c6261b1532731084b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signal that socket creation has completed. <br /></td></tr>
<tr class="separator:a5c99859ba8b1a0c6261b1532731084b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a57b3f731c07f001dfdf60b654748031e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a57b3f731c07f001dfdf60b654748031e"></a>
static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a57b3f731c07f001dfdf60b654748031e">port</a> = 3901</td></tr>
<tr class="memdesc:a57b3f731c07f001dfdf60b654748031e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer denoting the next port to start a listener on. <br /></td></tr>
<tr class="separator:a57b3f731c07f001dfdf60b654748031e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ae11a82ec9e7357bbe326f6ae0a6044ef"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae11a82ec9e7357bbe326f6ae0a6044ef"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#ae11a82ec9e7357bbe326f6ae0a6044ef">run</a> ()</td></tr>
<tr class="memdesc:ae11a82ec9e7357bbe326f6ae0a6044ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main loop function that receives messages and processes them for dispatch to the RDP listener. <br /></td></tr>
<tr class="separator:ae11a82ec9e7357bbe326f6ae0a6044ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a705ccedf6542410087343f1c7b0852de"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a705ccedf6542410087343f1c7b0852de"></a>
Glib::Thread *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a705ccedf6542410087343f1c7b0852de">out_thread</a></td></tr>
<tr class="memdesc:a705ccedf6542410087343f1c7b0852de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to worker thread spinning on the out loop. <br /></td></tr>
<tr class="separator:a705ccedf6542410087343f1c7b0852de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab559b849577dcadf848646e84a31a920"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab559b849577dcadf848646e84a31a920"></a>
Glib::Mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#ab559b849577dcadf848646e84a31a920">mutex</a></td></tr>
<tr class="memdesc:ab559b849577dcadf848646e84a31a920"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock guarding stop. <br /></td></tr>
<tr class="separator:ab559b849577dcadf848646e84a31a920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d8b949e82feadae696c939228836469"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0d8b949e82feadae696c939228836469"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a0d8b949e82feadae696c939228836469">stop</a></td></tr>
<tr class="memdesc:a0d8b949e82feadae696c939228836469"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable set to indicate when the <a class="el" href="classRDPServerWorker.html" title="The RDPServerWorker class manages the lifetime of the nanomsg socket and the RDP server and connectio...">RDPServerWorker</a> is stopping. <br /></td></tr>
<tr class="separator:a0d8b949e82feadae696c939228836469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e71eeed0ce158d30ab26c8cf0f6392c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2e71eeed0ce158d30ab26c8cf0f6392c"></a>
Glib::ustring&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a2e71eeed0ce158d30ab26c8cf0f6392c">socket_path</a></td></tr>
<tr class="memdesc:a2e71eeed0ce158d30ab26c8cf0f6392c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Path to the socket in the filesystem. <br /></td></tr>
<tr class="separator:a2e71eeed0ce158d30ab26c8cf0f6392c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab73f628b94575e40ef244d54f2660be8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab73f628b94575e40ef244d54f2660be8"></a>
nn::socket *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#ab73f628b94575e40ef244d54f2660be8">sock</a></td></tr>
<tr class="memdesc:ab73f628b94575e40ef244d54f2660be8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the nanomsg socket. <br /></td></tr>
<tr class="separator:ab73f628b94575e40ef244d54f2660be8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c48c40c5664ecf56813d064a669a74c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c48c40c5664ecf56813d064a669a74c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a7c48c40c5664ecf56813d064a669a74c">vm_id</a></td></tr>
<tr class="memdesc:a7c48c40c5664ecf56813d064a669a74c"><td class="mdescLeft">&#160;</td><td class="mdescRight">ID of the VM associated with this <a class="el" href="classRDPServerWorker.html" title="The RDPServerWorker class manages the lifetime of the nanomsg socket and the RDP server and connectio...">RDPServerWorker</a> object. <br /></td></tr>
<tr class="separator:a7c48c40c5664ecf56813d064a669a74c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1213594452fcb78e45b988c0bc059c0a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1213594452fcb78e45b988c0bc059c0a"></a>
<a class="el" href="classRDPListener.html">RDPListener</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRDPServerWorker.html#a1213594452fcb78e45b988c0bc059c0a">l</a></td></tr>
<tr class="memdesc:a1213594452fcb78e45b988c0bc059c0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to the <a class="el" href="classRDPListener.html" title="C++ class wrapping the freerdp_listener struct associated with the RDP server. ">RDPListener</a> object spawned by this VM. <br /></td></tr>
<tr class="separator:a1213594452fcb78e45b988c0bc059c0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classRDPServerWorker.html" title="The RDPServerWorker class manages the lifetime of the nanomsg socket and the RDP server and connectio...">RDPServerWorker</a> class manages the lifetime of the nanomsg socket and the RDP server and connection associated with the VM. </p>
<p>RDPServerWorkers are spawned when a VM registers with the RDPMux server, and manage the lifecycle of the communication socket associated with the VM and the RDP server spawned to interact with the VM and client. They exist for as long as the VM associated with the connection is alive, and are closed when the VM itself closes.</p>
<p>RDPServerworkers manage the deserialization of messages from the VM, and dispatching messages to the RDP listener. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a593ca371fd4c7fd166e7cf43a1a1d664"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RDPServerWorker::RDPServerWorker </td>
          <td>(</td>
          <td class="paramtype">const Glib::ustring &amp;&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vm_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a new RDPServerworker object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>File path to the nanomsg socket in the filesystem </td></tr>
    <tr><td class="paramname">vm_id</td><td>ID of the VM. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3a33ae474a9bf36d9da56087928abce2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RDPServerWorker::~RDPServerWorker </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Safely takes down the server worker. </p>
<p>Sets stop to true to indicate to the worker thread to stop processing, then joins the thread and waits for completion. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a3deed9d9cfc2362acff5c859b803bf31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RDPServerWorker::processIncomingMessage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classQueueItem.html">QueueItem</a> *&#160;</td>
          <td class="paramname"><em>item</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes incoming messages and dispatches them to the listener appropriately. </p>
<p>This function is called once the deserializes incoming messages into an stl::vector and sends that vector to the RDP listener.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">item</td><td>The item to deserialize. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="RDPServerWorker_8h_source.html">RDPServerWorker.h</a></li>
<li>src/RDPServerWorker.cpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classRDPServerWorker.html">RDPServerWorker</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
